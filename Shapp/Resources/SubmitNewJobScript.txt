#!/usr/bin/env python2
# -*- coding: utf-8 -*-
import classad
import htcondor
import os
import random


work = dict(
    Cmd=r"{0}",
    Iwd=r"{1}",
    UserLog=r"{2}",
    Output=r"{3}",
    Error=r"{4}",
    Input=r"{5}",
    TransferInputFiles=r"{6}",
    Arguments=r"{7}",
    Env=r"{8}",
    Requirements=r"{9}"
)
work = dict((k, v) for k, v in work.iteritems() if v)
sub = htcondor.Submit(work)
schedd = htcondor.Schedd()
with schedd.transaction() as txn:
    cluster_id = sub.queue(txn, 1)
    # first submitted job has process number as 0 (as CLUSTER.PROC_NO)
    print(str(cluster_id) + ".0")

